{"remainingRequest":"C:\\Users\\JThorneUMN\\Documents\\GitHub\\dendro-plots\\plotting-app\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\JThorneUMN\\Documents\\GitHub\\dendro-plots\\plotting-app\\src\\modules\\splines.js","dependencies":[{"path":"C:\\Users\\JThorneUMN\\Documents\\GitHub\\dendro-plots\\plotting-app\\src\\modules\\splines.js","mtime":1630445564695},{"path":"C:\\Users\\JThorneUMN\\Documents\\GitHub\\dendro-plots\\plotting-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\JThorneUMN\\Documents\\GitHub\\dendro-plots\\plotting-app\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkM6L1VzZXJzL0pUaG9ybmVVTU4vRG9jdW1lbnRzL0dpdEh1Yi9kZW5kcm8tcGxvdHMvcGxvdHRpbmctYXBwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCBzaW1wbGVTbW9vdGhpbmdTcGxpbmUgZnJvbSAnc2ltcGxlLXNtb290aGluZy1zcGxpbmUnOwppbXBvcnQgc3RvcmUgZnJvbSAnLi9zdG9yZS5qcyc7Cgp2YXIgY3JlYXRlU3BsaW5lID0gZnVuY3Rpb24gY3JlYXRlU3BsaW5lKHgsIHksIGZyZXEsIGlkLCBwcm9wKSB7CiAgY29uc29sZS5sb2coJ2NyZWF0ZWQgc3BsaW5lJyk7CiAgdmFyIGRhdGEgPSB4Lm1hcChmdW5jdGlvbiAoZSwgaSkgewogICAgdmFyIHBhaXIgPSB7CiAgICAgIHg6IGUsCiAgICAgIHk6IHlbaV0KICAgIH07CiAgICByZXR1cm4gcGFpcjsKICB9KTsKICB2YXIgbGFtYmRhID0gMC4wMDAwMSAqIE1hdGgucG93KDIsIDkuOTc4NCAqIE1hdGgubG9nKGZyZXEpICsgMy45NzUpOwogIHZhciBzcGxpbmUgPSBzaW1wbGVTbW9vdGhpbmdTcGxpbmUoZGF0YSwgewogICAgJ2xhbWJkYSc6IGxhbWJkYQogIH0pOwogIHZhciB4QXJyID0gW107CiAgdmFyIHlBcnIgPSBbXTsKCiAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHNwbGluZS5wb2ludHMpLAogICAgICBfc3RlcDsKCiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBvYmogPSBfc3RlcC52YWx1ZTsKICAgICAgeEFyci5wdXNoKG9iai54KTsKICAgICAgeUFyci5wdXNoKG9iai55KTsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9pdGVyYXRvci5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvci5mKCk7CiAgfQoKICB2YXIgc3BsaW5lRGF0YSA9IHsKICAgIHg6IHhBcnIsCiAgICB5OiB5QXJyCiAgfTsgLy8gc2F2ZSBzcGxpbmUgdG8gc3BsaW5lIGNhY2hlIGluIHN0b3JlLmpzCgogIHZhciBzcGxpbmVPYmo7CiAgdmFyIHNwbGluZUV4aXN0cyA9IHN0b3JlLmNhY2hlLnNwbGluZXNbcHJvcF0uZmluZChmdW5jdGlvbiAobykgewogICAgcmV0dXJuIG8uaWQgPT0gaWQ7CiAgfSk7CgogIGlmIChzcGxpbmVFeGlzdHMpIHsKICAgIHNwbGluZU9iaiA9IHNwbGluZUV4aXN0czsKICB9IGVsc2UgewogICAgc3BsaW5lT2JqID0gbmV3IE9iamVjdCgpOwogICAgc3BsaW5lT2JqLmlkID0gaWQ7CiAgICBzdG9yZS5jYWNoZS5zcGxpbmVzW3Byb3BdLnB1c2goc3BsaW5lT2JqKTsKICB9CgogIHNwbGluZU9ialtmcmVxXSA9IHsKICAgIHg6IHhBcnIsCiAgICB5OiB5QXJyCiAgfTsKICByZXR1cm4gc3BsaW5lRGF0YTsKfTsKCnZhciBjcmVhdGVJbmRleCA9IGZ1bmN0aW9uIGNyZWF0ZUluZGV4KHJhd1gsIHJhd1ksIHNwbGluZSkgewogIGNvbnNvbGUubG9nKCdjcmVhdGVkIGluZGV4Jyk7CiAgdmFyIHggPSByYXdYOwogIHZhciB5ID0gcmF3WC5tYXAoZnVuY3Rpb24gKGUsIGkpIHsKICAgIHZhciBqID0gc3BsaW5lLnguaW5kZXhPZihlKTsKCiAgICBpZiAoaiA9PT0gLTEpIHsKICAgICAgLy8gZmluZCBjbG9zZXN0IHZhbHVlIHRvIHVzZSBmb3IgY2FsY3VsYXRpb24KICAgICAgdmFyIG4gPSBzcGxpbmUueC5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIGN1cnIpIHsKICAgICAgICByZXR1cm4gTWF0aC5hYnMoY3VyciAtIGUpIDwgTWF0aC5hYnMocHJldiAtIGUpID8gY3VyciA6IHByZXY7CiAgICAgIH0pOwogICAgICBqID0gc3BsaW5lLnguaW5kZXhPZihuKTsKICAgIH0KCiAgICByZXR1cm4gcmF3WVtpXSAvIHNwbGluZS55W2pdOwogIH0pOwogIHJldHVybiB7CiAgICB4OiB4LAogICAgeTogeQogIH07Cn07CgpleHBvcnQgeyBjcmVhdGVTcGxpbmUsIGNyZWF0ZUluZGV4IH07"},{"version":3,"sources":["C:/Users/JThorneUMN/Documents/GitHub/dendro-plots/plotting-app/src/modules/splines.js"],"names":["simpleSmoothingSpline","store","createSpline","x","y","freq","id","prop","console","log","data","map","e","i","pair","lambda","Math","pow","spline","xArr","yArr","points","obj","push","splineData","splineObj","splineExists","cache","splines","find","o","Object","createIndex","rawX","rawY","j","indexOf","n","reduce","prev","curr","abs"],"mappings":"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","sourcesContent":["import simpleSmoothingSpline from 'simple-smoothing-spline'\r\nimport store from './store.js'\r\n\r\nconst createSpline = function(x, y, freq, id, prop) {\r\n  console.log('created spline')\r\n\r\n  let data = x.map((e, i) => {\r\n    let pair = {\r\n      x: e,\r\n      y: y[i]\r\n    }\r\n    return pair\r\n  })\r\n\r\n  let lambda = 0.00001 * Math.pow(2, 9.9784 * Math.log(freq) + 3.975)\r\n  const spline = simpleSmoothingSpline(data, { 'lambda': lambda })\r\n\r\n  let xArr = []\r\n  let yArr = []\r\n  for (const obj of spline.points) {\r\n    xArr.push(obj.x)\r\n    yArr.push(obj.y)\r\n  }\r\n\r\n  let splineData = {\r\n    x: xArr,\r\n    y: yArr\r\n  }\r\n\r\n  // save spline to spline cache in store.js\r\n  let splineObj\r\n  let splineExists = store.cache.splines[prop].find(o => o.id == id)\r\n  if (splineExists) {\r\n    splineObj = splineExists\r\n  } else {\r\n    splineObj = new Object()\r\n    splineObj.id = id\r\n    store.cache.splines[prop].push(splineObj)\r\n  }\r\n  splineObj[freq] = {\r\n    x: xArr,\r\n    y: yArr,\r\n  }\r\n\r\n  return splineData\r\n}\r\n\r\nconst createIndex = function(rawX, rawY, spline) {\r\n  console.log('created index')\r\n\r\n  let x = rawX\r\n  let y = rawX.map((e, i) => {\r\n    let j = spline.x.indexOf(e)\r\n    if (j === -1) {\r\n      // find closest value to use for calculation\r\n      let n = spline.x.reduce((prev, curr) => {\r\n        return (Math.abs(curr - e) < Math.abs(prev - e) ? curr : prev);\r\n      })\r\n      j = spline.x.indexOf(n)\r\n    }\r\n    return rawY[i] / spline.y[j]\r\n  })\r\n\r\n  return { x: x, y: y }\r\n}\r\n\r\nexport { createSpline, createIndex }\r\n"]}]}